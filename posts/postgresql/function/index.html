<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>常用函数 | Helium</title>
<meta name="keywords" content="pgsql">
<meta name="description" content="pgSQL 常用函数简介。">
<meta name="author" content="helium">
<link rel="canonical" href="https://helium.github.io/posts/postgresql/function/">
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<meta name="referrer" content="no-referrer-when-downgrade">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://helium.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://helium.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://helium.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://helium.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://helium.github.io/apple-touch-icon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://helium.github.io/posts/postgresql/function/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<html>
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jetbrains-mono@1.0.6/css/jetbrains-mono-nl.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css" />
    <link rel="stylesheet" href="https://cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.6.0/style.css" />
    <style>
        body {
            font-family: "LXGW WenKai Lite", sans-serif;
            font-family: "LXGW WenKai Screen", sans-serif;
        }
    </style>
</head>
</html>

  

<meta property="og:title" content="常用函数" />
<meta property="og:description" content="pgSQL 常用函数简介。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://helium.github.io/posts/postgresql/function/" />
<meta property="og:image" content="https://helium.github.io/favicon-32x32.png" />
<meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-09-19T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-09-19T00:00:00+00:00" /><meta property="og:site_name" content="Helium" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://helium.github.io/favicon-32x32.png" />
<meta name="twitter:title" content="常用函数"/>
<meta name="twitter:description" content="pgSQL 常用函数简介。"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Article",
      "item": "https://helium.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "PostgreSQL",
      "item": "https://helium.github.io/posts/postgresql/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "常用函数",
      "item": "https://helium.github.io/posts/postgresql/function/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "常用函数",
  "name": "常用函数",
  "description": "pgSQL 常用函数简介。",
  "keywords": [
    "pgsql"
  ],
  "articleBody": "数学函数 算数运算符 运算符 描述 示例 结果 + 加法 2 + 3 5 - 减法 2 - 3 -1 * 乘法 2 * 3 6 / 整除 5 / 2 2 % 模除（求余） 5 % 4 1 ^ 求幂（左边为底数，右边为指数） 2.0 ^ 3.0 8 |/ 平方根 |/ 25.0 5 ||/ 立方根 ||/ 27.0 3 ! 阶乘(测试失败) 5 ! 120 !! 阶乘（前置运算符）(测试失败) !! 5 120 @ 绝对值(注意空格) @ -5.0 5 \u0026 按位与 91 \u0026 15 11 | 按位或 32 | 3 35 # 按位异或 17 # 5 20 ~ 按位非 ~1 -2 « 按位左移 1 « 4 16 » 按位右移 8 » 2 2 绝对值 abs(x)函数用于计算 x 的绝对值。 SELECT abs(-17.4); -- | abs | -- |------| -- | 17.4 | 取整 ceil(dp)/ceiling(dp)函数用于计算大于或等于 dp 的最小整数。 floor(dp)函数用于计算小于或等于 dp 的最大整数。 round(dp)函数四舍五入为整数。 trunc(dp)函数向零取整。 SELECT ceil(-42.8), floor(-42.8), round(12.45), trunc(12.8); -- | ceil | floor | round | trunc | -- |------|-------|-------|-------| -- | -42 | -43 | 12 | 12 | 另外，round(dp, s)函数四舍五入到 s 位小数。 trunc(dp, s)函数截断到 s 位小数。 SELECT round(12.4565, 2), round(12.4564, 3); -- | round | round(1) | -- |-------|----------| -- | 12.46 | 12.456 | SELECT trunc(12.4565, 2), trunc(12.4564, 3); -- | trunc | trunc(1) | -- |-------|----------| -- | 12.45 | 12.456 | 乘方与开方 power(a, b)函数计算 a 的 b 次方。 sqrt(dp)函数计算 dp 的平方根。 cbrt(dp)函数计算 dp 的立方根。 SELECT power(2, 3), sqrt(4), cbrt(27); -- | power | sqrt | cbrt | -- |-------|------|--------------------| -- | 8 | 2 | 3.0000000000000004 | 指数与对数 exp(dp)函数计算以自然常数 e 为底的指数。 ln(dp)函数计算以自然常数 e 为底数的对数。 log(dp)/log10(dp)函数计算以 10 为底的对数。 log(b, x)函数计算以 b 为底的对数。 SELECT exp(1.0), ln(2.718281828459045), log(100), log(2.0, 16.0); -- | exp | ln | log | log(1) | -- |-------------------|--------------------|-----|--------------------| -- | 2.718281828459045 | 0.9999999999999999 | 2 | 4.0000000000000000 | 整数商和余数 div(y, x)函数计算 y 除以 x 的整数商。 mod(y, x)函数计算 y 除以 x 的余数。 SELECT div(9,4), mod(9,4); -- | div | mod | -- |-----|-----| -- | 2 | 1 | 弧度与角度 degrees(dp)函数用于将弧度转为角度。 radians(dp)函数用于将角度转弧度。 SELECT degrees(1.57), radians(90.0); -- | degrees | radians | -- |-------------------|--------------------| -- | 89.95437383553924 | 1.5707963267948966 | 常量 π pi()函数用于返回常量“π”的值。 SELECT pi(); -- | pi | -- |-------------------| -- | 3.141592653589793 | 符号函数 sign(dp)函数返回参数的正负号，可能的结果为-1、0、+1。 SELECT sign(-8.4); -- | sign | -- |------| -- | -1 | 生成随机数 PostgreSQL 提供了用于返回一个随机数的函数 random()。 SELECT random(); -- | random | -- |---------------------| -- | 0.895738968003343 | random()返回一个大于等于 0 小于 1 的随机数，类型为双精度浮点数。 setseed(dp)函数可以为随后一次运行的random()函数设置种子数，范围：-1.0 \u003c= dp \u003c= 1.0。 相同的种子可以得到相同的随机数，用于重现结果。 SELECT setseed(0); SELECT random(); -- | random | -- |-----------------------| -- | 3.907985046680551e-14 | 字符函数 字符串连接 concat(str, …)函数用于连接字符串，并且忽略其中的 NULL 参数。 concat_ws(sep, str, …)函数使用指定分隔符 sep 连接字符串。 SELECT concat(2, NULL, 22), concat_ws(' and ', 2, NULL, 22); -- | concat | concat_ws | -- |--------|-----------| -- | 222 | 2 and 22 | 两个竖杠（||）也可以用于连接字符串，但是 NULL 参数将会返回 NULL。 SELECT 'Post'||'greSQL', 'Post'||NULL||'greSQL'; -- | ?column? | ?column? | -- |------------|----------| -- | PostgreSQL | (null) | 字符与编码 ascii(string)函数返回第一个字符的 ASCII 码。对于 UTF8 返回 Unicode 码；对于其他多字节编码，参数必须是一个 ASCII 字符。 SELECT ascii('x'), ascii('好'); -- | ascii | ascii(1) | -- |-------|----------| -- | 120 | 22909 | chr(int)函数返回编码对应的字符。 对于 UTF8，参数指定的是 Unicode 码； 对于其他多字节编码，参数必须对应一个 ASCII 字符。 参数不允许为 0（空字符），因为 text 数据类型不能存储空字符。 SELECT chr(120), chr(22909); -- | chr | chr(1) | -- |-----|--------| -- | x | 好 | 字符串长度 bit_length(string)函数用于计算字符串包含的比特数。 length(string)、 char_length(string)、character_length(string)函数计算字符串包含的字符数。 octet_length(string) 函数计算字符串包含的字节数。 SELECT bit_length('jose'), bit_length('jo好se'), bit_length('jo1se'); -- | bit_length | bit_length(1) | bit_length(2) | -- |------------|---------------|---------------| -- | 32 | 56 | 40 | SELECT length('jose'), length('jo好se'), length('jo1se'); -- | length | length(1) | length(2) | -- |------------|---------------|---------------| -- | 4 | 5 | 5 | SELECT char_length('jose'), char_length('jo好se'), char_length('jo1se'); -- | char_length| char_length(1)| char_length(2)| -- |------------|---------------|---------------| -- | 4 | 5 | 5 | SELECT character_length('jose'), character_length('jo好se'), character_length('jo1se'); -- | character_length | character_length(1) | character_length(2) | -- |------------------|---------------------|---------------------| -- | 4 | 5 | 5 | SELECT octet_length('jose'), octet_length('jo好se'), octet_length('jo1se'); -- | octet_length | octet_length(1) | octet_length(2) | -- |--------------|-----------------|-----------------| -- | 4 | 7 | 5 | 大小写转换 lower(string)函数将字符串转换为小写形式。 upper(string)函数将字符串转换为大写形式。 initcap(string)函数将每个单词的首字母大写，其他字母小写。 SELECT lower('TOM'), upper('tom'), initcap('hi THOMAS'); -- | lower | upper | initcap | -- |-------|-------|-----------| -- | tom | TOM | Hi Thomas | 子串查找与替换 substring(string [FROM] [for])函数用于提取从位置 FROM 开始的 for 个字符子串，位置从 1 开始计算。 substr(string, FROM [, count])的作用相同。 SELECT substring('Thomas' FROM 2 for 3), substr('Thomas',2, 3); -- | substring | substr | -- |-----------|--------| -- | hom | hom | left(str, n)函数返回字符串左边的 n 个字符。如果 n 为负数，返回除了最后|n|个字符之外的所有字符。 right(str, n)函数返回字符串右边的 n 个字符。如果 n 为负数，返回除了左边|n|个字符之外的字符。 SELECT left('abcde', 2), left('abcde', -2); -- | left | left(1) | -- |------|---------| -- | ab | abc | SELECT right('abcde', 2), right('abcde', -2); -- | right | right(1) | -- |-------|----------| -- | de | cde | substring(string FROM pattern)函数提取匹配 POSIX 正则表达式的子串。 substring(string FROM pattern for escape)函数提取匹配 SQL 正则表达式的子串。 SELECT substring('Thomas' FROM '...$'), substring('Thomas' FROM '%#\"o_a#\"_' for '#'); -- | substring | substring | -- |-----------|-----------| -- | mas | oma | regexp_match(string, pattern [, flags])函数返回匹配 POSIX 正则表达式的第一个子串。 SELECT regexp_match('foobarbequebaz', '(bar)(beque)'); -- |regexp_match| -- |------------| -- |{bar,beque} | regexp_matches(string, pattern [, flags])函数返回匹配 POSIX 正则表达式的所有子串，结果是一个集合。 SELECT regexp_matches('foobarbequebaz', 'ba.', 'g'); -- | regexp_matches | -- |----------------| -- | {bar} | -- | {baz} | position(substring in string)返回子串的位置。 strpos(string, substring)函数的作用相同，但是参数顺序相反。 SELECT position('om' in 'Thomas'), strpos('Thomas', 'om'); -- | position | strpos | -- |----------|--------| -- | 3 | 3 | starts_with(string, prefix)函数判断 string 是否以 prefix 开头，如果是则返回 true；否则返回false。 SELECT starts_with('alphabet', 'alph'), starts_with('alphabet', 'alxh'); -- |starts_with|starts_with(1)| -- |-----------|--------------| -- | t | f | replace(string, FROM, to)函数将字符串 string 中的 FROM 子串替换为 to 子串。 regexp_replace(string, pattern, replacement [, flags])函数字符串 string 中匹配 POSIX 正则表达式pattern 的子串替换为 replacement。 SELECT replace('abcdefabcdef', 'cd', 'XX'), regexp_replace('Thomas','.[mN]a.', 'M'); -- | replace | regexp_replace | -- |--------------|----------------| -- | abXXefabXXef | ThM | translate(string , FROM , to)函数将字符串 string 中出现在 FROM 中的字符串替换成 to 中相应位置的字符。如果 FROM 长度大于 to，在 to 中没有对应值的字符将被删除。 SELECT translate('12345', '143', 'ax'); -- | translate | -- |-----------| -- | a2x5 | overlay(string placing substring FROM [for])函数使用 substring 覆盖字符串 string 中从FROM 开始的 for 个字符。 SELECT overlay('Txxxxas' placing 'hom' FROM 2 for 4); -- | overlay | -- |---------| -- | Thomas | 截断与填充 trim([leading | trailing | both] [characters] FROM string)函数从字符串的开头（leading）、结尾（trailing）或者两端（both）删除由指定字符 characters（默认为空格）组成的最长子串。 trim([leading | trailing | both] [FROM] string [, characters])函数的作用相同。 SELECT trim(both 'xyz' FROM 'yxTomxx'); -- | btrim | -- |-------| -- | Tom | btrim(string [, characters])函数的作用与上面 trim 函数的 both 选项相同。 ltrim(string [,characters])与上面 trim 函数的 leading 选项相同。 rtrim(string [, characters])函数上面 trim 函数的trailing 选项相同。 SELECT btrim('yxTomxx', 'xyz'), ltrim('yxTomxx', 'xyz'), rtrim('yxTomxx','xyz'); -- | btrim | ltrim | rtrim | -- |-------|-------|-------| -- | Tom | Tomxx | yxTom | lpad(string, length [, fill ])函数在 string 左侧使用 fill 中的字符（默认空格）进行填充，直到长度为 length。如果 string 长度大于 length，从右侧截断到长度 length。 rpad(string, length [, fill ])函数在 string 右侧使用 fill 中的字符（默认空格）进行填充，直到长度为 length。如果 string 长度大于 length，从右侧截断到长度 length。 repeat(string, number)函数将字符串 string 重复 N 次。 SELECT lpad('hi', 5, 'xy'), rpad('hi', 5, 'xy'), repeat('Pg', 4); -- | lpad | rpad | repeat | -- |-------|-------|----------| -- | xyxhi | hixyx | PgPgPgPg | 字符串格式化 format(formatstr , formatarg)用于对字符串格式化，类似于 C 语言中的 sprintf 函数。 SELECT format('Hello %s, %1$s', 'World'); -- | format | -- |--------------------| -- | Hello World, World | MD5 值 md5(string)函数用于返回十六进制格式的 MD5 值。 SELECT md5('abc'); -- | md5 | -- |----------------------------------| -- | 900150983cd24fb0d6963f7d28e17f72 | 字符串拆分 regexp_split_to_table(string, pattern[, flags])函数用于拆分字符串，使用 POSIX 正则表达式作为分隔符。函数的返回类型是 text 集合。 SELECT regexp_split_to_table('hello world', '\\s+'); -- | regexp_split_to_table | -- |-----------------------| -- | hello | -- | world | split_part(string, delimiter, field)函数使用 delimiter 拆分字符串，并返回指定项（从 1 开始计数）。 SELECT split_part('abc~@~def~@~ghi', '~@~', 2); -- | split_part | -- |------------| -- | def | 字符串反转 reverse(str)函数用于将字符串反转。 SELECT reverse('阿萨1的s黄金卡'); -- | reverse | -- |--------------| -- | 卡金黄s的1萨阿 | 日期函数 计算时间间隔 age(timestamp, timestamp)函数用于计算两个时间点之间的间隔， age(timestamp)函数用于计算当前日期的凌晨 12 点到该时间点之间的间隔。 SELECT age(timestamp '2020-12-31', timestamp '2020-01-01'), age(timestamp '2020-01-01'); -- | age | age(1) | -- |---------------|----------------------| -- |11 mons 30 days|4 years 8 mons 19 days| 获取时间中的信息 date_part(text, timestamp)和 extract(field FROM timestamp)函数用于获取日期时间中的某一部分，例如年份、月份、小时等。 date_part(text, interval)和 extract(field FROM interval)函数用于获取时间间隔中的某一部分。 SELECT date_part( 'year', TIMESTAMP '2020-03-03 20:38:40' ), EXTRACT ( YEAR FROM TIMESTAMP '2020-03-03 20:38:40' ), date_part( 'month', INTERVAL '1 years 5 months' ), EXTRACT ( MONTH FROM INTERVAL '1 years 5 months' ); -- |date_part|date_part|date_part|date_part| -- |---------|---------|---------|---------| -- | 2020 | 2020 | 5 | 5 | 通过返回字段的标题可以看出， extract 函数实际上也是调用了 date_part 函数，只是参数方式不同。 这两个函数支持获取的信息包括： century，世纪； day，对于 timestamp，返回月份中的第几天；对于 interval，返回天数； decade，年份除以 10； dow，星期天（0）到星期六（6）； doy，一年中的第几天，（1 - 365/366）； epoch，对于 timestamp WITH time zone，返回 1970-01-01 00:00:00 UTC 到该时间的秒数；对于 date 和 timestamp，回本地时间的 1970-01-01 00:00:00 到该时间的秒数；对于interval，返回以秒数表示的该时间间隔； hour，小时（1 - 23）； isodow， ISO 8601 标准中的星期一（1）到星期天（7）； isoyear， ISO 8601 标准定义的日期所在的年份。每年从包含 1 月 4 日的星期一开始，2017年 01 月 01 日属于 2016 年； microseconds，微秒，包含秒和小数秒在内的数字乘以 1000000； millennium，千年； milliseconds，毫秒，包含秒和小数秒在内的数字乘以 1000； minute，分钟，（ 0 - 59）； month，月份； quarter，季度，（ 1 - 4）； second，秒数，包含小数秒； timezone， UTC 时区，单位为秒； timezone_hour， UTC 时区中的小时部分； timezone_minute， UTC 时区中的分钟部分； week，ISO 8601 标准中的星期几，每年从第一个星期四所在的一周开始； year，年份。 截断日期/时间 date_trunc(field, source [, time_zone ])函数用于将 timestamp、 timestamp WITH time zone、date、 time 或者 interval 数据截断到指定的精度。 SELECT date_trunc( 'year', TIMESTAMP '2020-03-03 20:38:40' ), date_trunc( 'day', timestamptz '2020-03-03 20:38:40+00', 'Asia/Shanghai' ), date_trunc( 'hour', INTERVAL '2 days 3 hours 40 minutes' ); -- | date_trunc | date_trunc(1) | date_trunc(2) | -- | -------------------|----------------------|---------------| -- | 2020-01-01 00:00:00|2020-03-03 16:00:00+00|2 days 03:00:00| date_trunc 函数支持以下截断精度： microseconds milliseconds second minute hour day week month quarter year decade century millennium 创建日期/时间 make_date(year int, month int, day int)函数用于创建一个日期： SELECT make_date(2022, 03, 15); -- | make_date | -- |-----------| -- | 2022-03-15| make_interval(years int DEFAULT 0, months int DEFAULT 0, weeks int DEFAULT 0, days int DEFAULT 0, hours int DEFAULT 0, mins int DEFAULT 0, secs double precision DEFAULT 0.0)函数通过指定年、月、日等信息创建一个时间间隔。 SELECT make_interval(days =\u003e 1, hours =\u003e 5); -- | make_interval | -- |---------------| -- | 1 day 05:00:00| make_time(hour int, min int, sec double precision)函数通过指定小时、分钟和秒数创建一个时间。 SELECT make_time(1, 2, 30.5); -- | make_time | -- |------------| -- | 01:02:30.5 | make_timestamp(year int, month int, day int, hour int, min int, sec double precision) 函数通过指定年、月、日、时、分、秒创建一个时间戳。 SELECT make_timestamp(2020, 3, 15, 8, 20, 23.5); -- | make_timestamp | -- |----------------------| -- | 2020-03-15 08:20:23.5| make_timestamptz(year int, month int, day int, hour int, min int, sec double precision, [ timezone text ])函数通过指定年、月、日、时、分、秒创建一个带时区的时间戳。如果没有指定时区，使用当前时区。 SELECT make_timestamptz(2020, 3, 15, 8, 20, 23.5); -- | make_timestamptz | -- |-------------------------| -- | 2020-03-15 08:20:23.5+08| to_timestamp(double precision)函数将 Unix 时间戳（自从 1970-01-01 00:00:00+00 以来的秒数）转换为 PostgreSQL 时间戳数据。 SELECT to_timestamp(1583152349); -- | to_timestamp | -- |-----------------------| -- | 2020-03-02 12:32:29+00| 获取系统时间 PostgreSQL 提供了大量用于获取系统当前日期和时间的函数，例如 current_date、 current_time、current_timestamp、 clock_timestamp()、 localtimestamp、 now()、 statement_timestamp()等。 同时还支持延迟语句执行的 pg_sleep()等函数，具体可以可以参考这篇文章。 时区转换 AT TIME ZONE 运算符用于将 timestamp without time zone、 timestamp WITH time zone 以及 time WITH time zone 转换为指定时区中的时间。 SELECT TIMESTAMP '2020-03-03 20:38:40' AT TIME ZONE'Asia/Shanghai', TIMESTAMP WITH TIME ZONE'2020-03-03 20:38:40-05:00' AT TIME ZONE'Asia/Shanghai', TIME WITH TIME ZONE'20:38:40-05:00' AT TIME ZONE'Asia/Shanghai'; -- | timezone | timezone | timezone | -- |-----------------------|-------------------|-----------| -- | 2020-03-03 12:38:40+00|2020-03-04 09:38:40|09:38:40+08| timezone(zone, timestamp)函数等价于 SQL 标准中的 timestamp AT TIME ZONE zone。 还有一些关于日期时间的函数，可以参考官方文档。 类型转换 CAST 函数 CAST ( expr AS data_type )函数用于将 expr 转换为 data_type 数据类型。 PostgreSQL 类型转换运算符（::）也可以实现相同的功能。例如： SELECT CAST ('15' AS INTEGER), '2020-03-15'::DATE; -- | int4|date | -- |-----|----------| -- | 15 |2020-03-15| 如果数据无法转换为指定的类型，将会返回错误。 SELECT CAST ('A15' AS INTEGER); --SQL 错误 [22P02]: 错误: 无效的类型 integer 输入语法: \"A15\" 位置： 14 to_date 函数 to_date(string, format)函数用于将字符串 string 按照 format 格式转换为日期类型。 SELECT to_date('2020/03/15','YYYY/MM/DD'); -- | to_date | -- |-----------| -- | 2020-03-15| 其中， YYYY 代表四位数的年； MM 代表两位数的月； DD 代表两位数的日。更多的格式选项可以参考官方文档。 to_timestamp 函数 to_timestamp(string, format)函数用于将字符串 string 按照 format 格式转换为 timestampWITH time zone 类型。 SELECT to_timestamp('2020-03-15 19:08:00.678', 'YYYY-MM-DD HH24:MI:SS.MS'); -- | to_timestamp | -- |---------------------------| -- | 2020-03-15 19:08:00.678+08| 其中， HH24 表示 24 小时制的小时； MI 表示分钟； SS 表示秒数； MS 表示毫秒数。 to_char 函数 to_char(expre, format)函数用于将 timestamp、 interval、 integer、 double precision 或者 numeric类型的值转换为指定格式的字符串。 SELECT to_char(current_timestamp, 'HH24:MI:SS'), to_char(interval '5h 12m 30s', 'HH12:MI:SS'), to_char(-125.8, '999D99'); -- | to_char |to_char |to_char| -- |---------|--------|-------| -- | 21:30:22|05:12:30|-125.80| to_number 函数 to_number(string, format)函数用于将字符串转换为数字。 SELECT to_number('￥125.8', 'L999D9'); -- | to_number| -- |----------| -- | 125.8 | 隐式类型转换 除了显式使用类型转换函数或运算符之外，很多时候 PostgreSQL 会自动执行数据类型的隐式转换。例如： SELECT 1+'2', 'todo: '||current_timestamp; -- | ?column?|?column? | -- |---------|----------------------------------| -- | 3 |todo:2020-03-09 21:49:49.370621+08| ",
  "wordCount" : "1871",
  "inLanguage": "zh",
  "image": "https://helium.github.io/favicon-32x32.png","datePublished": "2024-09-19T00:00:00Z",
  "dateModified": "2024-09-19T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "helium"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://helium.github.io/posts/postgresql/function/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Helium",
    "logo": {
      "@type": "ImageObject",
      "url": "https://helium.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://helium.github.io/" accesskey="h" title="Blog (Alt + H)">
                <img src="https://helium.github.io/helium.png" alt="" aria-label="logo"
                    height="35">Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://helium.github.io/" title="主页">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://helium.github.io/posts" title="文章">
                    <span>Article</span>
                </a>
            </li>
            <li>
                <a href="https://helium.github.io/archives" title="时间轴">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://helium.github.io/tags/" title="标签">
                    <span>Tag</span>
                </a>
            </li>
            <li>
                <a href="https://helium.github.io/search/" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://helium.github.io/support" title="打赏">
                    <span>🫶Help</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">


<article class="post" autonumbering>
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://helium.github.io/">主页</a>&nbsp;»&nbsp;<a href="https://helium.github.io/posts/">Article</a>&nbsp;»&nbsp;<a href="https://helium.github.io/posts/postgresql/">PostgreSQL</a></div>
    <h1 class="post-title entry-hint-parent">
      常用函数
    </h1>
    <div class="post-meta">










<span class="x-post-meta-item"><svg t="1720837714681" class="icon" viewBox="0 0 1084 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7520" width="200" height="200"><path d="M123.47509 1023.984942a123.565437 123.565437 0 0 1-123.505206-123.32451V243.863302A123.565437 123.565437 0 0 1 123.47509 120.568908h171.630374V26.06529a26.050232 26.050232 0 0 1 52.070349 0v94.503618h377.592848V26.06529a26.050232 26.050232 0 0 1 52.100464 0v94.503618h183.797189A123.565437 123.565437 0 0 1 1084.171519 243.863302v656.79713A123.565437 123.565437 0 0 1 960.666314 1023.984942H123.47509z m-71.404741-123.32451A71.434857 71.434857 0 0 0 123.47509 971.974825h837.191224a71.434857 71.434857 0 0 0 71.404741-71.314393V442.326922l-946.361273-3.824716a25.598494 25.598494 0 0 1-5.84248-0.692665l-27.796953-6.444798v469.295689zM123.47509 172.579025a71.434857 71.434857 0 0 0-71.404741 71.284277v149.736133l27.796953-6.444797a26.080348 26.080348 0 0 1 5.902712-0.662549l946.301041 3.824716V243.863302a71.404741 71.404741 0 0 0-71.404741-71.284277h-180.183284l-6.173754 12.859479a26.200812 26.200812 0 0 1-23.490383 14.786895 26.261043 26.261043 0 0 1-23.520499-14.786895l-6.173754-12.859479H350.819834l-6.173754 12.859479a26.200812 26.200812 0 0 1-23.490383 14.786895 26.230928 26.230928 0 0 1-23.520499-14.786895l-6.173755-12.859479H123.47509z m156.150814 578.827128a26.050232 26.050232 0 0 1-26.050232-25.990001c0-14.335157 11.68496-26.020116 26.050232-26.020116h521.697312c14.365273 0 26.050232 11.68496 26.050233 26.020116a26.050232 26.050232 0 0 1-26.050233 25.990001H279.625904z" fill="#3D3F42" p-id="7521"></path></svg><span>2024-09-19</span></span>&nbsp;<span class="x-post-meta-item"><svg t="1720839329181" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="14106" width="200" height="200"><path d="M699.270662 190.485379c-0.411369 0-0.821715 0.011256-1.227967 0.032746H507.034407a23.041786 23.041786 0 0 0-1.221828-0.031723c-12.779048 0-23.140023 10.359952-23.140023 23.139 0 12.781094 10.360975 23.141046 23.140023 23.141046v0.032746h193.458083v-0.032746c12.780071 0 23.141046-10.359952 23.141047-23.141046 0-12.780071-10.360975-23.140023-23.141047-23.140023zM979.215516 724.005508c0-142.090159-115.186416-257.277598-257.277598-257.277598-72.245418 0-137.532353 29.777187-184.262654 77.725223l45.868677 31.474852c36.227086-33.873482 84.882226-54.617945 138.393977-54.617945 111.945605 0 202.696492 90.750887 202.696492 202.695468h-43.01263l70.331835 104.289228 70.331835-104.289228H979.215516z" fill="" p-id="14107"></path><path d="M748.885664 588.843132c0-14.881942-12.06785-26.945699-26.947746-26.945698-14.883989 0-26.947745 12.063757-26.947745 26.945698v135.164423c0 14.879895 12.063757 26.945699 26.947745 26.945699h107.786889c14.881942 0 26.945699-12.063757 26.945698-26.945699s-12.063757-26.945699-26.945698-26.945699h-80.839143V588.843132zM721.937918 926.702c-111.947651 0-202.696492-90.74884-202.696492-202.696492 0-0.144286 0.004093-0.285502 0.004094-0.429788h43.004443l-70.330812-104.289228-70.331835 104.289228h43.075051c0 0.144286-0.00307 0.285502-0.00307 0.429788 0 142.091182 115.187439 257.279644 257.278621 257.279645 72.241324 0 137.530306-29.77821 184.260607-77.727269l-45.86663-31.474852c-36.227086 33.873482-84.884272 54.618968-138.393977 54.618968zM694.633039 423.38066c-1.354857-11.487635-11.120268-20.400632-22.972201-20.400632H206.362486c-12.780071 0-23.140023 10.359952-23.140023 23.138999 0 12.781094 10.359952 23.141046 23.140023 23.141047H596.949252c30.209022-13.81668 63.104223-22.76754 97.683787-25.879414zM438.548616 623.143333H206.362486c-12.780071 0-23.140023 10.358929-23.140023 23.140023 0 12.780071 10.359952 23.140023 23.140023 23.140023h219.956598a298.463626 298.463626 0 0 1 12.229532-46.280046zM506.934123 513.062192H206.362486c-12.780071 0-23.140023 10.359952-23.140023 23.139 0 12.781094 10.359952 23.140023 23.140023 23.140023H469.936487a302.241672 302.241672 0 0 1 36.997636-46.279023z" fill="" p-id="14108"></path><path d="M442.765661 835.277778a298.531164 298.531164 0 0 1-14.365173-46.150087H146.542052v-0.065491c-33.036417 0-59.81941-26.78197-59.81941-59.819411V329.36031h704.907545v100.905154a298.561863 298.561863 0 0 1 46.150086 14.996552V194.619536h-0.162706c0-53.422723-43.307342-96.728018-96.730065-96.728018h-68.89409V84.418668c0-33.037441-26.782993-59.81941-59.81941-59.81941v-0.361227h-18.87079v0.032745c-33.038464 0-59.820434 26.78197-59.820433 59.819411 0 0.109494 0.008186 0.218988 0.008186 0.328481h-0.339738v13.47285H345.203648V84.418668c0-33.037441-26.782993-59.81941-59.819411-59.81941v-0.361227h-18.872836v0.032745c-33.036417 0-59.81941 26.78197-59.81941 59.819411 0 0.109494 0.007163 0.218988 0.008186 0.328481h-0.339737v13.47285h-69.189826c-53.4217 0-96.729042 43.306318-96.729041 96.728018 0 1.701758 0.045025 3.39226 0.132006 5.071505v533.785166a98.051153 98.051153 0 0 0-0.132006 5.071506c0 53.4217 43.307342 96.728018 96.729041 96.728018v0.001023h305.595047zM86.723665 204.056466c0-33.037441 26.782993-59.81941 59.819411-59.819411 0.044002 0 0.086981 0.00307 0.130983 0.00307v-0.068561h105.968473V94.874811h0.032746a22.807449 22.807449 0 0 1-0.032746-1.215688c0-12.779048 10.360975-23.140023 23.140023-23.140023s23.140023 10.360975 23.140023 23.140023c0 0.408299-0.010233 0.812505-0.031722 1.215688h0.031722v49.297776h280.508696V94.874811h0.032745a22.807449 22.807449 0 0 1-0.032745-1.215688c0-12.779048 10.361999-23.140023 23.140023-23.140023 12.780071 0 23.141046 10.360975 23.141046 23.140023 0 0.408299-0.011256 0.812505-0.032746 1.215688h0.032746v49.297776h106.10048v0.065492c33.035394 0 59.818387 26.780947 59.818387 59.81941h0.130983V283.080264H86.723665v-79.023798z" fill="" p-id="14109"></path></svg><span>2024-09-19</span></span>&nbsp;<span class="x-post-meta-item"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none"
     stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select: text;">
    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" style="user-select: text;"></path>
    <polyline points="14 2 14 8 20 8" style="user-select: text;"></polyline>
    <line x1="16" y1="13" x2="8" y2="13" style="user-select: text;"></line>
    <line x1="16" y1="17" x2="8" y2="17" style="user-select: text;"></line>
    <polyline points="10 9 9 9 8 9" style="user-select: text;"></polyline>
</svg><span>1871字</span></span>&nbsp;<span class="x-post-meta-item"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none"
     stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <circle cx="12" cy="12" r="9"></circle>
    <polyline points="12 7 12 12 15 15"></polyline>
</svg><span>9分钟</span></span>&nbsp;<span class="x-post-meta-item"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none"
     stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <circle cx="12" cy="7" r="4"></circle>
    <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"></path>
</svg><span>helium</span></span>
      <span class="x-post-meta-item">
        &nbsp;<svg t="1720840393161" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="18680" width="200" height="200"><path d="M995.125144 559.61812l-415.998603-415.998602A52.986489 52.986489 0 0 0 541.413335 127.99957H338.847348c-3.166656-26.559911-9.286635-51.046495-17.999939-71.333094C299.734146 7.333309 271.154242 0 256.00096 0c-13.939953 0-40.439864 6.339979-61.259794 48.806503-10.473298 21.366595-17.946606 48.966502-21.573261 79.193067H53.334974a53.393154 53.393154 0 0 0-53.333154 53.333154v360.078791a52.986489 52.986489 0 0 0 15.619948 37.713206l415.998602 415.998603a53.333154 53.333154 0 0 0 75.426413 0l26.286579-26.293245 26.286578 26.293245a53.426487 53.426487 0 0 0 16.719944 11.333295 21.333262 21.333262 0 0 0 36.079879 11.293295l382.705381-382.705381a53.399821 53.399821 0 0 0 0-75.426413z m-762.070774-491.998347C241.494342 50.373164 250.667645 42.666523 256.00096 42.666523c5.99998 0 16.573278 9.639968 25.646581 30.806564 6.493312 15.159949 11.333295 33.999886 14.146619 54.526483H216.16776c3.206656-23.419921 9.013303-44.359851 16.88661-60.41313z m243.819181 897.330319a10.666631 10.666631 0 0 1-15.079949 0l-415.998603-415.998603A10.573298 10.573298 0 0 1 42.668343 541.411515V181.332724a10.666631 10.666631 0 0 1 10.666631-10.666631h245.332509c0 47.853173-10.373298 92.15969-27.066575 115.632945-5.926647 8.326639-16.566611 14.186619-22.306592 16.113279C204.041135 314.752276 170.667913 356.218803 170.667913 405.331972c0 58.813136 47.853173 106.666308 106.666309 106.666308s106.666308-47.853173 106.666308-106.666308c0-47.086508-30.666564-87.139707-73.079754-101.246327C330.060711 272.705751 341.334007 223.692582 341.334007 170.666093h72.079758a10.573298 10.573298 0 0 1 7.539974 3.126656l415.998603 415.998603a10.666631 10.666631 0 0 1 0 15.079949zM341.334007 405.331972a63.999785 63.999785 0 1 1-63.999785-63.999785 64.073118 64.073118 0 0 1 63.999785 63.999785z m263.539114 559.61812a10.666631 10.666631 0 0 1-15.079949 0L563.499927 938.663513l303.625647-303.61898a53.399821 53.399821 0 0 0 0-75.426413L478.16688 170.666093h63.246455a10.573298 10.573298 0 0 1 7.539974 3.126656l415.998603 415.998603c0.239999 0.239999 0.466665 0.486665 0.666664 0.746664l0.086667 0.106666a10.666631 10.666631 0 0 1 0 13.373289l-0.086667 0.106666c-0.213333 0.259999-0.439999 0.506665-0.666664 0.746664z" fill="#5C5C66" p-id="18681"></path></svg>
        <ul class="post-tags-meta" style="display: inline-block;font-size: 14px;">
            <a href="https://helium.github.io/tags/pgsql/" target="_blank" rel="noopener">Pgsql</a>
        </ul>
      </span>
      
      <span id="busuanzi_container_page_pv" class="x-post-meta-item">
        &nbsp;<svg t="1720844685710" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="27237" width="200" height="200"><path d="M739.754667 574.08c-121.386667 45.610667-208.469333 169.813333-208.64 316.16 0 33.408 4.693333 65.493333 13.141333 95.914667H94.122667c-26.453333-43.52-41.685333-91.946667-41.685334-143.189334 0-185.173333 192.896-335.104 430.805334-335.104 96.256 0 184.832 24.746667 256.512 66.218667z m-280.490667-114.986667a214.869333 214.869333 0 0 1-214.869333-215.04A215.04 215.04 0 0 1 459.264 28.842667a215.04 215.04 0 0 1 215.04 215.210666 215.04 215.04 0 0 1-215.04 215.04zM974.506667 641.28c9.856 0 17.834667 7.466667 17.834666 16.64v59.989333c-0.341333 8.789333-7.850667 15.786667-17.28 16.085334-9.856 0.341333-18.176-6.826667-18.517333-16.085334v-20.053333l-99.114667 91.093333-0.256 0.256a18.474667 18.474667 0 0 1-14.848 4.352h-0.768a18.176 18.176 0 0 1-9.344-4.608l-0.938666-0.981333-85.930667-80.042667-123.562667 115.072a18.773333 18.773333 0 0 1-25.216 0 15.786667 15.786667 0 0 1 0-23.466666l136.149334-126.848 0.725333-0.597334a18.645333 18.645333 0 0 1 24.362667 0.512l87.253333 81.237334 86.058667-79.232h-21.248c-9.386667-0.298667-16.938667-7.338667-17.28-16.085334-0.341333-9.173333 7.381333-16.896 17.28-17.237333h64.64z m-367.146667 240h48.128c8.874667 0 16.042667 7.168 16.042667 16.042667v72.192a16.042667 16.042667 0 0 1-16.042667 16.042666h-48.128a16.042667 16.042667 0 0 1-16.042667-16.042666v-72.192c0-8.874667 7.210667-16.042667 16.042667-16.042667z m110.805333-106.666667h48.128c8.874667 0 16.042667 7.168 16.042667 16.042667v178.858667a16.042667 16.042667 0 0 1-16.042667 16.042666h-48.128a16.042667 16.042667 0 0 1-16.042666-16.042666v-178.858667c0-8.874667 7.168-16.042667 16.042666-16.042667z m106.538667 80h48.128c8.874667 0 16.042667 7.168 16.042667 16.042667v99.413333a16.042667 16.042667 0 0 1-16.042667 16.042667H824.746667a16.042667 16.042667 0 0 1-16.042667-16.042667v-99.413333c0-8.874667 7.168-16.042667 16.042667-16.042667z m110.165333-80h48.128c8.874667 0 16.042667 7.168 16.042667 16.042667v179.413333a16.042667 16.042667 0 0 1-16.042667 16.042667h-48.128a16.042667 16.042667 0 0 1-16.042666-16.042667v-179.413333c0-8.874667 7.210667-16.042667 16.042666-16.042667z" fill="#999999" p-id="27238"></path></svg>
        <span id="busuanzi_value_page_pv"></span>
      </span>

</div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">目录</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e6%95%b0%e5%ad%a6%e5%87%bd%e6%95%b0" aria-label="数学函数">数学函数</a><ul>
                            
                    <li>
                        <a href="#%e7%ae%97%e6%95%b0%e8%bf%90%e7%ae%97%e7%ac%a6" aria-label="算数运算符">算数运算符</a></li>
                    <li>
                        <a href="#%e7%bb%9d%e5%af%b9%e5%80%bc" aria-label="绝对值">绝对值</a></li>
                    <li>
                        <a href="#%e5%8f%96%e6%95%b4" aria-label="取整">取整</a></li>
                    <li>
                        <a href="#%e4%b9%98%e6%96%b9%e4%b8%8e%e5%bc%80%e6%96%b9" aria-label="乘方与开方">乘方与开方</a></li>
                    <li>
                        <a href="#%e6%8c%87%e6%95%b0%e4%b8%8e%e5%af%b9%e6%95%b0" aria-label="指数与对数">指数与对数</a></li>
                    <li>
                        <a href="#%e6%95%b4%e6%95%b0%e5%95%86%e5%92%8c%e4%bd%99%e6%95%b0" aria-label="整数商和余数">整数商和余数</a></li>
                    <li>
                        <a href="#%e5%bc%a7%e5%ba%a6%e4%b8%8e%e8%a7%92%e5%ba%a6" aria-label="弧度与角度">弧度与角度</a></li>
                    <li>
                        <a href="#%e5%b8%b8%e9%87%8f-%cf%80" aria-label="常量 π">常量 π</a></li>
                    <li>
                        <a href="#%e7%ac%a6%e5%8f%b7%e5%87%bd%e6%95%b0" aria-label="符号函数">符号函数</a></li>
                    <li>
                        <a href="#%e7%94%9f%e6%88%90%e9%9a%8f%e6%9c%ba%e6%95%b0" aria-label="生成随机数">生成随机数</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e5%ad%97%e7%ac%a6%e5%87%bd%e6%95%b0" aria-label="字符函数">字符函数</a><ul>
                            
                    <li>
                        <a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2%e8%bf%9e%e6%8e%a5" aria-label="字符串连接">字符串连接</a></li>
                    <li>
                        <a href="#%e5%ad%97%e7%ac%a6%e4%b8%8e%e7%bc%96%e7%a0%81" aria-label="字符与编码">字符与编码</a></li>
                    <li>
                        <a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2%e9%95%bf%e5%ba%a6" aria-label="字符串长度">字符串长度</a></li>
                    <li>
                        <a href="#%e5%a4%a7%e5%b0%8f%e5%86%99%e8%bd%ac%e6%8d%a2" aria-label="大小写转换">大小写转换</a></li>
                    <li>
                        <a href="#%e5%ad%90%e4%b8%b2%e6%9f%a5%e6%89%be%e4%b8%8e%e6%9b%bf%e6%8d%a2" aria-label="子串查找与替换">子串查找与替换</a></li>
                    <li>
                        <a href="#%e6%88%aa%e6%96%ad%e4%b8%8e%e5%a1%ab%e5%85%85" aria-label="截断与填充">截断与填充</a></li>
                    <li>
                        <a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%a0%bc%e5%bc%8f%e5%8c%96" aria-label="字符串格式化">字符串格式化</a></li>
                    <li>
                        <a href="#md5-%e5%80%bc" aria-label="MD5 值">MD5 值</a></li>
                    <li>
                        <a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%8b%86%e5%88%86" aria-label="字符串拆分">字符串拆分</a></li>
                    <li>
                        <a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%8f%8d%e8%bd%ac" aria-label="字符串反转">字符串反转</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%97%a5%e6%9c%9f%e5%87%bd%e6%95%b0" aria-label="日期函数">日期函数</a><ul>
                            
                    <li>
                        <a href="#%e8%ae%a1%e7%ae%97%e6%97%b6%e9%97%b4%e9%97%b4%e9%9a%94" aria-label="计算时间间隔">计算时间间隔</a></li>
                    <li>
                        <a href="#%e8%8e%b7%e5%8f%96%e6%97%b6%e9%97%b4%e4%b8%ad%e7%9a%84%e4%bf%a1%e6%81%af" aria-label="获取时间中的信息">获取时间中的信息</a></li>
                    <li>
                        <a href="#%e6%88%aa%e6%96%ad%e6%97%a5%e6%9c%9f%e6%97%b6%e9%97%b4" aria-label="截断日期/时间">截断日期/时间</a></li>
                    <li>
                        <a href="#%e5%88%9b%e5%bb%ba%e6%97%a5%e6%9c%9f%e6%97%b6%e9%97%b4" aria-label="创建日期/时间">创建日期/时间</a></li>
                    <li>
                        <a href="#%e8%8e%b7%e5%8f%96%e7%b3%bb%e7%bb%9f%e6%97%b6%e9%97%b4" aria-label="获取系统时间">获取系统时间</a></li>
                    <li>
                        <a href="#%e6%97%b6%e5%8c%ba%e8%bd%ac%e6%8d%a2" aria-label="时区转换">时区转换</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e7%b1%bb%e5%9e%8b%e8%bd%ac%e6%8d%a2" aria-label="类型转换">类型转换</a><ul>
                            
                    <li>
                        <a href="#cast-%e5%87%bd%e6%95%b0" aria-label="CAST 函数">CAST 函数</a></li>
                    <li>
                        <a href="#to_date-%e5%87%bd%e6%95%b0" aria-label="to_date 函数">to_date 函数</a></li>
                    <li>
                        <a href="#to_timestamp-%e5%87%bd%e6%95%b0" aria-label="to_timestamp 函数">to_timestamp 函数</a></li>
                    <li>
                        <a href="#to_char-%e5%87%bd%e6%95%b0" aria-label="to_char 函数">to_char 函数</a></li>
                    <li>
                        <a href="#to_number-%e5%87%bd%e6%95%b0" aria-label="to_number 函数">to_number 函数</a></li>
                    <li>
                        <a href="#%e9%9a%90%e5%bc%8f%e7%b1%bb%e5%9e%8b%e8%bd%ac%e6%8d%a2" aria-label="隐式类型转换">隐式类型转换</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>
  <div class="post-content"><h2 id="数学函数">数学函数<a hidden class="anchor" aria-hidden="true" href="#数学函数">#</a></h2>
<h3 id="算数运算符">算数运算符<a hidden class="anchor" aria-hidden="true" href="#算数运算符">#</a></h3>
<table>
<thead>
<tr>
<th style="text-align:center">运算符</th>
<th style="text-align:center">描述</th>
<th style="text-align:center">示例</th>
<th style="text-align:center">结果</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">+</td>
<td style="text-align:center">加法</td>
<td style="text-align:center">2 + 3</td>
<td style="text-align:center">5</td>
</tr>
<tr>
<td style="text-align:center">-</td>
<td style="text-align:center">减法</td>
<td style="text-align:center">2 - 3</td>
<td style="text-align:center">-1</td>
</tr>
<tr>
<td style="text-align:center">*</td>
<td style="text-align:center">乘法</td>
<td style="text-align:center">2 * 3</td>
<td style="text-align:center">6</td>
</tr>
<tr>
<td style="text-align:center">/</td>
<td style="text-align:center">整除</td>
<td style="text-align:center">5 / 2</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">%</td>
<td style="text-align:center">模除（求余）</td>
<td style="text-align:center">5 % 4</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">^</td>
<td style="text-align:center">求幂（左边为底数，右边为指数）</td>
<td style="text-align:center">2.0 ^ 3.0</td>
<td style="text-align:center">8</td>
</tr>
<tr>
<td style="text-align:center">|/</td>
<td style="text-align:center">平方根</td>
<td style="text-align:center">|/ 25.0</td>
<td style="text-align:center">5</td>
</tr>
<tr>
<td style="text-align:center">||/</td>
<td style="text-align:center">立方根</td>
<td style="text-align:center">||/ 27.0</td>
<td style="text-align:center">3</td>
</tr>
<tr>
<td style="text-align:center">!</td>
<td style="text-align:center">阶乘(测试失败)</td>
<td style="text-align:center">5 !</td>
<td style="text-align:center">120</td>
</tr>
<tr>
<td style="text-align:center">!!</td>
<td style="text-align:center">阶乘（前置运算符）(测试失败)</td>
<td style="text-align:center">!! 5</td>
<td style="text-align:center">120</td>
</tr>
<tr>
<td style="text-align:center">@</td>
<td style="text-align:center">绝对值(注意空格)</td>
<td style="text-align:center">@ -5.0</td>
<td style="text-align:center">5</td>
</tr>
<tr>
<td style="text-align:center">&amp;</td>
<td style="text-align:center">按位与</td>
<td style="text-align:center">91 &amp; 15</td>
<td style="text-align:center">11</td>
</tr>
<tr>
<td style="text-align:center">|</td>
<td style="text-align:center">按位或</td>
<td style="text-align:center">32 | 3</td>
<td style="text-align:center">35</td>
</tr>
<tr>
<td style="text-align:center">#</td>
<td style="text-align:center">按位异或</td>
<td style="text-align:center">17 # 5</td>
<td style="text-align:center">20</td>
</tr>
<tr>
<td style="text-align:center">~</td>
<td style="text-align:center">按位非</td>
<td style="text-align:center">~1</td>
<td style="text-align:center">-2</td>
</tr>
<tr>
<td style="text-align:center">&laquo;</td>
<td style="text-align:center">按位左移</td>
<td style="text-align:center">1 &laquo; 4</td>
<td style="text-align:center">16</td>
</tr>
<tr>
<td style="text-align:center">&raquo;</td>
<td style="text-align:center">按位右移</td>
<td style="text-align:center">8 &raquo; 2</td>
<td style="text-align:center">2</td>
</tr>
</tbody>
</table>
<h3 id="绝对值">绝对值<a hidden class="anchor" aria-hidden="true" href="#绝对值">#</a></h3>
<ol>
<li>abs(x)函数用于计算 x 的绝对值。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">abs</span><span class="p">(</span><span class="o">-</span><span class="mi">17</span><span class="p">.</span><span class="mi">4</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | abs  |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 17.4 |
</span></span></span></code></pre></div><h3 id="取整">取整<a hidden class="anchor" aria-hidden="true" href="#取整">#</a></h3>
<ol>
<li>ceil(dp)/ceiling(dp)函数用于计算大于或等于 dp 的最小整数。</li>
<li>floor(dp)函数用于计算小于或等于 dp 的最大整数。</li>
<li>round(dp)函数四舍五入为整数。</li>
<li>trunc(dp)函数向零取整。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">ceil</span><span class="p">(</span><span class="o">-</span><span class="mi">42</span><span class="p">.</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="n">floor</span><span class="p">(</span><span class="o">-</span><span class="mi">42</span><span class="p">.</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="n">round</span><span class="p">(</span><span class="mi">12</span><span class="p">.</span><span class="mi">45</span><span class="p">),</span><span class="w"> </span><span class="n">trunc</span><span class="p">(</span><span class="mi">12</span><span class="p">.</span><span class="mi">8</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | ceil | floor | round | trunc |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |------|-------|-------|-------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | -42  | -43   | 12    | 12    |
</span></span></span></code></pre></div><ol start="5">
<li>另外，round(dp, s)函数四舍五入到 s 位小数。</li>
<li>trunc(dp, s)函数截断到 s 位小数。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">round</span><span class="p">(</span><span class="mi">12</span><span class="p">.</span><span class="mi">4565</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">round</span><span class="p">(</span><span class="mi">12</span><span class="p">.</span><span class="mi">4564</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | round | round(1) |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-------|----------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 12.46 | 12.456   |
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">trunc</span><span class="p">(</span><span class="mi">12</span><span class="p">.</span><span class="mi">4565</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">trunc</span><span class="p">(</span><span class="mi">12</span><span class="p">.</span><span class="mi">4564</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | trunc | trunc(1) |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-------|----------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 12.45 | 12.456   |
</span></span></span></code></pre></div><h3 id="乘方与开方">乘方与开方<a hidden class="anchor" aria-hidden="true" href="#乘方与开方">#</a></h3>
<ol>
<li>power(a, b)函数计算 a 的 b 次方。</li>
<li>sqrt(dp)函数计算 dp 的平方根。</li>
<li>cbrt(dp)函数计算 dp 的立方根。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">power</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="n">cbrt</span><span class="p">(</span><span class="mi">27</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | power | sqrt | cbrt               |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-------|------|--------------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 8     | 2    | 3.0000000000000004 |
</span></span></span></code></pre></div><h3 id="指数与对数">指数与对数<a hidden class="anchor" aria-hidden="true" href="#指数与对数">#</a></h3>
<ol>
<li>exp(dp)函数计算以自然常数 e 为底的指数。</li>
<li>ln(dp)函数计算以自然常数 e 为底数的对数。</li>
<li>log(dp)/log10(dp)函数计算以 10 为底的对数。</li>
<li>log(b, x)函数计算以 b 为底的对数。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">ln</span><span class="p">(</span><span class="mi">2</span><span class="p">.</span><span class="mi">718281828459045</span><span class="p">),</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">.</span><span class="mi">0</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | exp               | ln                 | log | log(1)             |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-------------------|--------------------|-----|--------------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 2.718281828459045 | 0.9999999999999999 | 2   | 4.0000000000000000 |
</span></span></span></code></pre></div><h3 id="整数商和余数">整数商和余数<a hidden class="anchor" aria-hidden="true" href="#整数商和余数">#</a></h3>
<ol>
<li>div(y, x)函数计算 y 除以 x 的整数商。</li>
<li>mod(y, x)函数计算 y 除以 x 的余数。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">div</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="k">mod</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | div | mod |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-----|-----|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 2   | 1   |
</span></span></span></code></pre></div><h3 id="弧度与角度">弧度与角度<a hidden class="anchor" aria-hidden="true" href="#弧度与角度">#</a></h3>
<ol>
<li>degrees(dp)函数用于将弧度转为角度。</li>
<li>radians(dp)函数用于将角度转弧度。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">degrees</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">57</span><span class="p">),</span><span class="w"> </span><span class="n">radians</span><span class="p">(</span><span class="mi">90</span><span class="p">.</span><span class="mi">0</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | degrees           | radians            |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-------------------|--------------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 89.95437383553924 | 1.5707963267948966 |
</span></span></span></code></pre></div><h3 id="常量-π">常量 π<a hidden class="anchor" aria-hidden="true" href="#常量-π">#</a></h3>
<ol>
<li>pi()函数用于返回常量“π”的值。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">pi</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | pi                |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-------------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 3.141592653589793 |
</span></span></span></code></pre></div><h3 id="符号函数">符号函数<a hidden class="anchor" aria-hidden="true" href="#符号函数">#</a></h3>
<ol>
<li>sign(dp)函数返回参数的正负号，可能的结果为-1、0、+1。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">sign</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="mi">4</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | sign |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | -1   |
</span></span></span></code></pre></div><h3 id="生成随机数">生成随机数<a hidden class="anchor" aria-hidden="true" href="#生成随机数">#</a></h3>
<ol>
<li>PostgreSQL 提供了用于返回一个随机数的函数 random()。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">random</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | random              |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |---------------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 0.895738968003343   |
</span></span></span></code></pre></div><ol start="2">
<li>random()返回一个大于等于 0 小于 1 的随机数，类型为双精度浮点数。</li>
<li>setseed(dp)函数可以为随后一次运行的random()函数设置种子数，范围：-1.0 &lt;= dp &lt;= 1.0。
<ul>
<li>相同的种子可以得到相同的随机数，用于重现结果。</li>
</ul>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">setseed</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">random</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | random                |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-----------------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 3.907985046680551e-14 |
</span></span></span></code></pre></div><h2 id="字符函数">字符函数<a hidden class="anchor" aria-hidden="true" href="#字符函数">#</a></h2>
<h3 id="字符串连接">字符串连接<a hidden class="anchor" aria-hidden="true" href="#字符串连接">#</a></h3>
<ol>
<li>concat(str, …)函数用于连接字符串，并且忽略其中的 NULL 参数。</li>
<li>concat_ws(sep, str, …)函数使用指定分隔符 sep 连接字符串。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">concat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">22</span><span class="p">),</span><span class="w"> </span><span class="n">concat_ws</span><span class="p">(</span><span class="s1">&#39; and &#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">22</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | concat | concat_ws |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |--------|-----------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 222    | 2 and 22  |
</span></span></span></code></pre></div><ol start="3">
<li>两个竖杠（||）也可以用于连接字符串，但是 NULL 参数将会返回 NULL。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;Post&#39;</span><span class="o">||</span><span class="s1">&#39;greSQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Post&#39;</span><span class="o">||</span><span class="k">NULL</span><span class="o">||</span><span class="s1">&#39;greSQL&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | ?column?   | ?column? |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |------------|----------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | PostgreSQL | (null)   |
</span></span></span></code></pre></div><h3 id="字符与编码">字符与编码<a hidden class="anchor" aria-hidden="true" href="#字符与编码">#</a></h3>
<ol>
<li>ascii(string)函数返回第一个字符的 ASCII 码。对于 UTF8 返回 Unicode 码；对于其他多字节编码，参数必须是一个 ASCII 字符。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">ascii</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">ascii</span><span class="p">(</span><span class="s1">&#39;好&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | ascii | ascii(1) |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-------|----------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 120   | 22909    |
</span></span></span></code></pre></div><ol start="2">
<li>chr(int)函数返回编码对应的字符。
<ul>
<li>对于 UTF8，参数指定的是 Unicode 码；</li>
<li>对于其他多字节编码，参数必须对应一个 ASCII 字符。</li>
<li>参数不允许为 0（空字符），因为 text 数据类型不能存储空字符。</li>
</ul>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">chr</span><span class="p">(</span><span class="mi">120</span><span class="p">),</span><span class="w"> </span><span class="n">chr</span><span class="p">(</span><span class="mi">22909</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | chr | chr(1) |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-----|--------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | x   | 好      |
</span></span></span></code></pre></div><h3 id="字符串长度">字符串长度<a hidden class="anchor" aria-hidden="true" href="#字符串长度">#</a></h3>
<ol>
<li>bit_length(string)函数用于计算字符串包含的比特数。</li>
<li>length(string)、 char_length(string)、character_length(string)函数计算字符串包含的字符数。</li>
<li>octet_length(string) 函数计算字符串包含的字节数。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">bit_length</span><span class="p">(</span><span class="s1">&#39;jose&#39;</span><span class="p">),</span><span class="w"> </span><span class="k">bit_length</span><span class="p">(</span><span class="s1">&#39;jo好se&#39;</span><span class="p">),</span><span class="w"> </span><span class="k">bit_length</span><span class="p">(</span><span class="s1">&#39;jo1se&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | bit_length | bit_length(1) | bit_length(2) |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |------------|---------------|---------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |     32     |      56       |      40       |
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">length</span><span class="p">(</span><span class="s1">&#39;jose&#39;</span><span class="p">),</span><span class="w"> </span><span class="k">length</span><span class="p">(</span><span class="s1">&#39;jo好se&#39;</span><span class="p">),</span><span class="w"> </span><span class="k">length</span><span class="p">(</span><span class="s1">&#39;jo1se&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | length     | length(1)     | length(2)     |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |------------|---------------|---------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |     4      |      5        |      5        |
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">char_length</span><span class="p">(</span><span class="s1">&#39;jose&#39;</span><span class="p">),</span><span class="w"> </span><span class="k">char_length</span><span class="p">(</span><span class="s1">&#39;jo好se&#39;</span><span class="p">),</span><span class="w"> </span><span class="k">char_length</span><span class="p">(</span><span class="s1">&#39;jo1se&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | char_length| char_length(1)| char_length(2)|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |------------|---------------|---------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |     4      |      5        |      5        |
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">character_length</span><span class="p">(</span><span class="s1">&#39;jose&#39;</span><span class="p">),</span><span class="w"> </span><span class="k">character_length</span><span class="p">(</span><span class="s1">&#39;jo好se&#39;</span><span class="p">),</span><span class="w"> </span><span class="k">character_length</span><span class="p">(</span><span class="s1">&#39;jo1se&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | character_length | character_length(1) | character_length(2) |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |------------------|---------------------|---------------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |        4         |         5           |         5           |
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">octet_length</span><span class="p">(</span><span class="s1">&#39;jose&#39;</span><span class="p">),</span><span class="w"> </span><span class="k">octet_length</span><span class="p">(</span><span class="s1">&#39;jo好se&#39;</span><span class="p">),</span><span class="w"> </span><span class="k">octet_length</span><span class="p">(</span><span class="s1">&#39;jo1se&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | octet_length | octet_length(1) | octet_length(2) |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |--------------|-----------------|-----------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |     4        |      7          |      5          |
</span></span></span></code></pre></div><h3 id="大小写转换">大小写转换<a hidden class="anchor" aria-hidden="true" href="#大小写转换">#</a></h3>
<ol>
<li>lower(string)函数将字符串转换为小写形式。</li>
<li>upper(string)函数将字符串转换为大写形式。</li>
<li>initcap(string)函数将每个单词的首字母大写，其他字母小写。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">lower</span><span class="p">(</span><span class="s1">&#39;TOM&#39;</span><span class="p">),</span><span class="w"> </span><span class="k">upper</span><span class="p">(</span><span class="s1">&#39;tom&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">initcap</span><span class="p">(</span><span class="s1">&#39;hi THOMAS&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | lower | upper | initcap   |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-------|-------|-----------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | tom   | TOM   | Hi Thomas |
</span></span></span></code></pre></div><h3 id="子串查找与替换">子串查找与替换<a hidden class="anchor" aria-hidden="true" href="#子串查找与替换">#</a></h3>
<ol>
<li>substring(string [FROM] [for])函数用于提取从位置 FROM 开始的 for 个字符子串，位置从 1 开始计算。</li>
<li>substr(string, FROM [, count])的作用相同。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="s1">&#39;Thomas&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">substr</span><span class="p">(</span><span class="s1">&#39;Thomas&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | substring | substr |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-----------|--------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | hom       | hom    |
</span></span></span></code></pre></div><ol start="3">
<li>left(str, n)函数返回字符串左边的 n 个字符。如果 n 为负数，返回除了最后|n|个字符之外的所有字符。</li>
<li>right(str, n)函数返回字符串右边的 n 个字符。如果 n 为负数，返回除了左边|n|个字符之外的字符。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">left</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="k">left</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | left | left(1) |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |------|---------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | ab   | abc     |
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">right</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="k">right</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | right | right(1) |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-------|----------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | de    | cde      |
</span></span></span></code></pre></div><ol start="5">
<li>substring(string FROM pattern)函数提取匹配 POSIX 正则表达式的子串。</li>
<li>substring(string FROM pattern for escape)函数提取匹配 SQL 正则表达式的子串。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="s1">&#39;Thomas&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;...$&#39;</span><span class="p">),</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="s1">&#39;Thomas&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;%#&#34;o_a#&#34;_&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="s1">&#39;#&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | substring | substring |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-----------|-----------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | mas       | oma       |
</span></span></span></code></pre></div><ol start="7">
<li>regexp_match(string, pattern [, flags])函数返回匹配 POSIX 正则表达式的第一个子串。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">regexp_match</span><span class="p">(</span><span class="s1">&#39;foobarbequebaz&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(bar)(beque)&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- |regexp_match|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |{bar,beque} |
</span></span></span></code></pre></div><ol start="8">
<li>regexp_matches(string, pattern [, flags])函数返回匹配 POSIX 正则表达式的所有子串，结果是一个集合。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">regexp_matches</span><span class="p">(</span><span class="s1">&#39;foobarbequebaz&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ba.&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;g&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | regexp_matches |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |----------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | {bar}          |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | {baz}          |
</span></span></span></code></pre></div><ol start="9">
<li>position(substring in string)返回子串的位置。</li>
<li>strpos(string, substring)函数的作用相同，但是参数顺序相反。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">position</span><span class="p">(</span><span class="s1">&#39;om&#39;</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s1">&#39;Thomas&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">strpos</span><span class="p">(</span><span class="s1">&#39;Thomas&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;om&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | position | strpos |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |----------|--------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 3        | 3      |
</span></span></span></code></pre></div><ol start="11">
<li>starts_with(string, prefix)函数判断 string 是否以 prefix 开头，如果是则返回 true；否则返回false。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">starts_with</span><span class="p">(</span><span class="s1">&#39;alphabet&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;alph&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">starts_with</span><span class="p">(</span><span class="s1">&#39;alphabet&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;alxh&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- |starts_with|starts_with(1)|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-----------|--------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | t         | f            |
</span></span></span></code></pre></div><ol start="12">
<li>replace(string, FROM, to)函数将字符串 string 中的 FROM 子串替换为 to 子串。</li>
<li>regexp_replace(string, pattern, replacement [, flags])函数字符串 string 中匹配 POSIX 正则表达式pattern 的子串替换为 replacement。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">replace</span><span class="p">(</span><span class="s1">&#39;abcdefabcdef&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;cd&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;XX&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">regexp_replace</span><span class="p">(</span><span class="s1">&#39;Thomas&#39;</span><span class="p">,</span><span class="s1">&#39;.[mN]a.&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;M&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | replace      | regexp_replace |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |--------------|----------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | abXXefabXXef | ThM            |
</span></span></span></code></pre></div><ol start="14">
<li>translate(string , FROM , to)函数将字符串 string 中出现在 FROM 中的字符串替换成 to 中相应位置的字符。如果 FROM 长度大于 to，在 to 中没有对应值的字符将被删除。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">translate</span><span class="p">(</span><span class="s1">&#39;12345&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;143&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ax&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | translate |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-----------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | a2x5      |
</span></span></span></code></pre></div><ol start="15">
<li>overlay(string placing substring FROM [for])函数使用 substring 覆盖字符串 string 中从FROM 开始的 for 个字符。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">overlay</span><span class="p">(</span><span class="s1">&#39;Txxxxas&#39;</span><span class="w"> </span><span class="k">placing</span><span class="w"> </span><span class="s1">&#39;hom&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | overlay |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |---------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | Thomas  |
</span></span></span></code></pre></div><h3 id="截断与填充">截断与填充<a hidden class="anchor" aria-hidden="true" href="#截断与填充">#</a></h3>
<ol>
<li>trim([leading | trailing | both] [characters] FROM string)函数从字符串的开头（leading）、结尾（trailing）或者两端（both）删除由指定字符 characters（默认为空格）组成的最长子串。</li>
<li>trim([leading | trailing | both] [FROM] string [, characters])函数的作用相同。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">trim</span><span class="p">(</span><span class="k">both</span><span class="w"> </span><span class="s1">&#39;xyz&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;yxTomxx&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | btrim |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | Tom   |
</span></span></span></code></pre></div><ol start="3">
<li>btrim(string [, characters])函数的作用与上面 trim 函数的 both 选项相同。</li>
<li>ltrim(string [,characters])与上面 trim 函数的 leading 选项相同。</li>
<li>rtrim(string [, characters])函数上面 trim 函数的trailing 选项相同。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">btrim</span><span class="p">(</span><span class="s1">&#39;yxTomxx&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;xyz&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">ltrim</span><span class="p">(</span><span class="s1">&#39;yxTomxx&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;xyz&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">rtrim</span><span class="p">(</span><span class="s1">&#39;yxTomxx&#39;</span><span class="p">,</span><span class="s1">&#39;xyz&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | btrim | ltrim | rtrim |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-------|-------|-------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | Tom   | Tomxx | yxTom |
</span></span></span></code></pre></div><ol start="6">
<li>lpad(string, length [, fill ])函数在 string 左侧使用 fill 中的字符（默认空格）进行填充，直到长度为 length。如果 string 长度大于 length，从右侧截断到长度 length。</li>
<li>rpad(string, length [, fill ])函数在 string 右侧使用 fill 中的字符（默认空格）进行填充，直到长度为 length。如果 string 长度大于 length，从右侧截断到长度 length。</li>
<li>repeat(string, number)函数将字符串 string 重复 N 次。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">lpad</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;xy&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">rpad</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;xy&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">repeat</span><span class="p">(</span><span class="s1">&#39;Pg&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | lpad  | rpad  | repeat   |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-------|-------|----------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | xyxhi | hixyx | PgPgPgPg |
</span></span></span></code></pre></div><h3 id="字符串格式化">字符串格式化<a hidden class="anchor" aria-hidden="true" href="#字符串格式化">#</a></h3>
<ol>
<li>format(formatstr , formatarg)用于对字符串格式化，类似于 C 语言中的 sprintf 函数。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Hello %s, %1$s&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;World&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | format             |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |--------------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | Hello World, World |
</span></span></span></code></pre></div><h3 id="md5-值">MD5 值<a hidden class="anchor" aria-hidden="true" href="#md5-值">#</a></h3>
<ol>
<li>md5(string)函数用于返回十六进制格式的 MD5 值。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">md5</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | md5                              |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |----------------------------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 900150983cd24fb0d6963f7d28e17f72 |
</span></span></span></code></pre></div><h3 id="字符串拆分">字符串拆分<a hidden class="anchor" aria-hidden="true" href="#字符串拆分">#</a></h3>
<ol>
<li>regexp_split_to_table(string, pattern[, flags])函数用于拆分字符串，使用 POSIX 正则表达式作为分隔符。函数的返回类型是 text 集合。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">regexp_split_to_table</span><span class="p">(</span><span class="s1">&#39;hello world&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\s+&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | regexp_split_to_table |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-----------------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | hello                 |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | world                 |
</span></span></span></code></pre></div><ol start="2">
<li>split_part(string, delimiter, field)函数使用 delimiter 拆分字符串，并返回指定项（从 1 开始计数）。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">split_part</span><span class="p">(</span><span class="s1">&#39;abc~@~def~@~ghi&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;~@~&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | split_part |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | def        |
</span></span></span></code></pre></div><h3 id="字符串反转">字符串反转<a hidden class="anchor" aria-hidden="true" href="#字符串反转">#</a></h3>
<ol>
<li>reverse(str)函数用于将字符串反转。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;阿萨1的s黄金卡&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | reverse      |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |--------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 卡金黄s的1萨阿 |
</span></span></span></code></pre></div><h2 id="日期函数">日期函数<a hidden class="anchor" aria-hidden="true" href="#日期函数">#</a></h2>
<h3 id="计算时间间隔">计算时间间隔<a hidden class="anchor" aria-hidden="true" href="#计算时间间隔">#</a></h3>
<ol>
<li>age(timestamp, timestamp)函数用于计算两个时间点之间的间隔， age(timestamp)函数用于计算当前日期的凌晨 12 点到该时间点之间的间隔。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">age</span><span class="p">(</span><span class="k">timestamp</span><span class="w"> </span><span class="s1">&#39;2020-12-31&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">timestamp</span><span class="w"> </span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">age</span><span class="p">(</span><span class="k">timestamp</span><span class="w"> </span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | age           |         age(1)       |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |---------------|----------------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |11 mons 30 days|4 years 8 mons 19 days|
</span></span></span></code></pre></div><h3 id="获取时间中的信息">获取时间中的信息<a hidden class="anchor" aria-hidden="true" href="#获取时间中的信息">#</a></h3>
<ol>
<li>date_part(text, timestamp)和 extract(field FROM timestamp)函数用于获取日期时间中的某一部分，例如年份、月份、小时等。</li>
<li>date_part(text, interval)和 extract(field FROM interval)函数用于获取时间间隔中的某一部分。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">date_part</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2020-03-03 20:38:40&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">EXTRACT</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2020-03-03 20:38:40&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">date_part</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1 years 5 months&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">EXTRACT</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">MONTH</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1 years 5 months&#39;</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- |date_part|date_part|date_part|date_part|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |---------|---------|---------|---------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 2020    | 2020    | 5       | 5       |
</span></span></span></code></pre></div><ol start="3">
<li>通过返回字段的标题可以看出， extract 函数实际上也是调用了 date_part 函数，只是参数方式不同。</li>
<li>这两个函数支持获取的信息包括：
<ul>
<li>century，世纪；</li>
<li>day，对于 timestamp，返回月份中的第几天；对于 interval，返回天数；</li>
<li>decade，年份除以 10；</li>
<li>dow，星期天（0）到星期六（6）；</li>
<li>doy，一年中的第几天，（1 - 365/366）；</li>
<li>epoch，对于 timestamp WITH time zone，返回 1970-01-01 00:00:00 UTC 到该时间的秒数；对于 date 和 timestamp，回本地时间的 1970-01-01 00:00:00 到该时间的秒数；对于interval，返回以秒数表示的该时间间隔；</li>
<li>hour，小时（1 - 23）；</li>
<li>isodow， ISO 8601 标准中的星期一（1）到星期天（7）；</li>
<li>isoyear， ISO 8601 标准定义的日期所在的年份。每年从包含 1 月 4 日的星期一开始，2017年 01 月 01 日属于 2016 年；</li>
<li>microseconds，微秒，包含秒和小数秒在内的数字乘以 1000000；</li>
<li>millennium，千年；</li>
<li>milliseconds，毫秒，包含秒和小数秒在内的数字乘以 1000；</li>
<li>minute，分钟，（ 0 - 59）；</li>
<li>month，月份；</li>
<li>quarter，季度，（ 1 - 4）；</li>
<li>second，秒数，包含小数秒；</li>
<li>timezone， UTC 时区，单位为秒；</li>
<li>timezone_hour， UTC 时区中的小时部分；</li>
<li>timezone_minute， UTC 时区中的分钟部分；</li>
<li>week，ISO 8601 标准中的星期几，每年从第一个星期四所在的一周开始；</li>
<li>year，年份。</li>
</ul>
</li>
</ol>
<h3 id="截断日期时间">截断日期/时间<a hidden class="anchor" aria-hidden="true" href="#截断日期时间">#</a></h3>
<ol>
<li>date_trunc(field, source [, time_zone ])函数用于将 timestamp、 timestamp WITH time zone、date、 time 或者 interval 数据截断到指定的精度。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">date_trunc</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2020-03-03 20:38:40&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">date_trunc</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;day&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">timestamptz</span><span class="w"> </span><span class="s1">&#39;2020-03-03 20:38:40+00&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Asia/Shanghai&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">date_trunc</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;hour&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;2 days 3 hours 40 minutes&#39;</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | date_trunc         | date_trunc(1)        | date_trunc(2) |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | -------------------|----------------------|---------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 2020-01-01 00:00:00|2020-03-03 16:00:00+00|2 days 03:00:00|
</span></span></span></code></pre></div><ol start="2">
<li>date_trunc 函数支持以下截断精度：
<ul>
<li>microseconds</li>
<li>milliseconds</li>
<li>second</li>
<li>minute</li>
<li>hour</li>
<li>day</li>
<li>week</li>
<li>month</li>
<li>quarter</li>
<li>year</li>
<li>decade</li>
<li>century</li>
<li>millennium</li>
</ul>
</li>
</ol>
<h3 id="创建日期时间">创建日期/时间<a hidden class="anchor" aria-hidden="true" href="#创建日期时间">#</a></h3>
<ol>
<li>make_date(year int, month int, day int)函数用于创建一个日期：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">make_date</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span><span class="w"> </span><span class="mi">03</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | make_date |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-----------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 2022-03-15|
</span></span></span></code></pre></div><ol start="2">
<li>make_interval(years int DEFAULT 0, months int DEFAULT 0, weeks int DEFAULT 0, days int DEFAULT 0, hours int DEFAULT 0, mins int DEFAULT 0, secs double precision DEFAULT 0.0)函数通过指定年、月、日等信息创建一个时间间隔。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">make_interval</span><span class="p">(</span><span class="n">days</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">hours</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | make_interval |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |---------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 1 day 05:00:00|
</span></span></span></code></pre></div><ol start="3">
<li>make_time(hour int, min int, sec double precision)函数通过指定小时、分钟和秒数创建一个时间。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">make_time</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">.</span><span class="mi">5</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | make_time  |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 01:02:30.5 |
</span></span></span></code></pre></div><ol start="4">
<li>make_timestamp(year int, month int, day int, hour int, min int, sec double precision) 函数通过指定年、月、日、时、分、秒创建一个时间戳。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">make_timestamp</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">23</span><span class="p">.</span><span class="mi">5</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | make_timestamp       |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |----------------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 2020-03-15 08:20:23.5|
</span></span></span></code></pre></div><ol start="5">
<li>make_timestamptz(year int, month int, day int, hour int, min int, sec double precision, [ timezone text ])函数通过指定年、月、日、时、分、秒创建一个带时区的时间戳。如果没有指定时区，使用当前时区。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">make_timestamptz</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">23</span><span class="p">.</span><span class="mi">5</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | make_timestamptz        |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-------------------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 2020-03-15 08:20:23.5+08|
</span></span></span></code></pre></div><ol start="6">
<li>to_timestamp(double precision)函数将 Unix 时间戳（自从 1970-01-01 00:00:00+00 以来的秒数）转换为 PostgreSQL 时间戳数据。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">to_timestamp</span><span class="p">(</span><span class="mi">1583152349</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | to_timestamp          |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-----------------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 2020-03-02 12:32:29+00|
</span></span></span></code></pre></div><h3 id="获取系统时间">获取系统时间<a hidden class="anchor" aria-hidden="true" href="#获取系统时间">#</a></h3>
<ol>
<li>PostgreSQL 提供了大量用于获取系统当前日期和时间的函数，例如 current_date、 current_time、current_timestamp、 clock_timestamp()、 localtimestamp、 now()、 statement_timestamp()等。</li>
<li>同时还支持延迟语句执行的 pg_sleep()等函数，具体可以可以参考<a href="https://tonydong.blog.csdn.net/article/details/102581249" target="_blank" rel="noopener">这篇文章</a>。</li>
</ol>
<h3 id="时区转换">时区转换<a hidden class="anchor" aria-hidden="true" href="#时区转换">#</a></h3>
<ol>
<li>AT TIME ZONE 运算符用于将 timestamp without time zone、 timestamp WITH time zone 以及 time WITH time zone 转换为指定时区中的时间。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s1">&#39;2020-03-03 20:38:40&#39;</span><span class="w"> </span><span class="k">AT</span><span class="w"> </span><span class="n">TIME</span><span class="w"> </span><span class="k">ZONE</span><span class="s1">&#39;Asia/Shanghai&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">TIME</span><span class="w"> </span><span class="k">ZONE</span><span class="s1">&#39;2020-03-03 20:38:40-05:00&#39;</span><span class="w"> </span><span class="k">AT</span><span class="w"> </span><span class="n">TIME</span><span class="w"> </span><span class="k">ZONE</span><span class="s1">&#39;Asia/Shanghai&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">TIME</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">TIME</span><span class="w"> </span><span class="k">ZONE</span><span class="s1">&#39;20:38:40-05:00&#39;</span><span class="w"> </span><span class="k">AT</span><span class="w"> </span><span class="n">TIME</span><span class="w"> </span><span class="k">ZONE</span><span class="s1">&#39;Asia/Shanghai&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | timezone              | timezone          | timezone  |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-----------------------|-------------------|-----------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 2020-03-03 12:38:40+00|2020-03-04 09:38:40|09:38:40+08|
</span></span></span></code></pre></div><ol start="2">
<li>timezone(zone, timestamp)函数等价于 SQL 标准中的 timestamp AT TIME ZONE zone。</li>
<li>还有一些关于日期时间的函数，可以参考<a href="https://www.postgresql.org/docs/current/functions-datetime.html" target="_blank" rel="noopener">官方文档</a>。</li>
</ol>
<h2 id="类型转换">类型转换<a hidden class="anchor" aria-hidden="true" href="#类型转换">#</a></h2>
<h3 id="cast-函数">CAST 函数<a hidden class="anchor" aria-hidden="true" href="#cast-函数">#</a></h3>
<ol>
<li>CAST ( expr AS data_type )函数用于将 expr 转换为 data_type 数据类型。</li>
<li>PostgreSQL 类型转换运算符（::）也可以实现相同的功能。例如：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;15&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;2020-03-15&#39;</span><span class="p">::</span><span class="nb">DATE</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | int4|date      |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-----|----------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 15  |2020-03-15|
</span></span></span></code></pre></div><ol start="3">
<li>如果数据无法转换为指定的类型，将会返回错误。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A15&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--SQL 错误 [22P02]: 错误: 无效的类型 integer 输入语法: &#34;A15&#34; 位置： 14
</span></span></span></code></pre></div><h3 id="to_date-函数">to_date 函数<a hidden class="anchor" aria-hidden="true" href="#to_date-函数">#</a></h3>
<ol>
<li>to_date(string, format)函数用于将字符串 string 按照 format 格式转换为日期类型。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;2020/03/15&#39;</span><span class="p">,</span><span class="s1">&#39;YYYY/MM/DD&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | to_date   |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |-----------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 2020-03-15|
</span></span></span></code></pre></div><ol start="2">
<li>其中， YYYY 代表四位数的年； MM 代表两位数的月； DD 代表两位数的日。更多的格式选项可以参考<a href="https://www.postgresql.org/docs/current/functions-formatting.html#FUNCTIONS-FORMATTING-DATETIME-TABLE" target="_blank" rel="noopener">官方文档</a>。</li>
</ol>
<h3 id="to_timestamp-函数">to_timestamp 函数<a hidden class="anchor" aria-hidden="true" href="#to_timestamp-函数">#</a></h3>
<ol>
<li>to_timestamp(string, format)函数用于将字符串 string 按照 format 格式转换为 timestampWITH time zone 类型。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">to_timestamp</span><span class="p">(</span><span class="s1">&#39;2020-03-15 19:08:00.678&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;YYYY-MM-DD HH24:MI:SS.MS&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | to_timestamp |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |---------------------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 2020-03-15 19:08:00.678+08|
</span></span></span></code></pre></div><ol start="2">
<li>其中， HH24 表示 24 小时制的小时； MI 表示分钟； SS 表示秒数； MS 表示毫秒数。</li>
</ol>
<h3 id="to_char-函数">to_char 函数<a hidden class="anchor" aria-hidden="true" href="#to_char-函数">#</a></h3>
<ol>
<li>to_char(expre, format)函数用于将 timestamp、 interval、 integer、 double precision 或者 numeric类型的值转换为指定格式的字符串。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">to_char</span><span class="p">(</span><span class="k">current_timestamp</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;HH24:MI:SS&#39;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">to_char</span><span class="p">(</span><span class="nb">interval</span><span class="w"> </span><span class="s1">&#39;5h 12m 30s&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;HH12:MI:SS&#39;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">to_char</span><span class="p">(</span><span class="o">-</span><span class="mi">125</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;999D99&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | to_char |to_char |to_char|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |---------|--------|-------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 21:30:22|05:12:30|-125.80|
</span></span></span></code></pre></div><h3 id="to_number-函数">to_number 函数<a hidden class="anchor" aria-hidden="true" href="#to_number-函数">#</a></h3>
<ol>
<li>to_number(string, format)函数用于将字符串转换为数字。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">to_number</span><span class="p">(</span><span class="s1">&#39;￥125.8&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;L999D9&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | to_number|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |----------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 125.8    |
</span></span></span></code></pre></div><h3 id="隐式类型转换">隐式类型转换<a hidden class="anchor" aria-hidden="true" href="#隐式类型转换">#</a></h3>
<ol>
<li>除了显式使用类型转换函数或运算符之外，很多时候 PostgreSQL 会自动执行数据类型的隐式转换。例如：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="o">+</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;todo: &#39;</span><span class="o">||</span><span class="k">current_timestamp</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- | ?column?|?column?                          |
</span></span></span><span class="line"><span class="cl"><span class="c1">-- |---------|----------------------------------|
</span></span></span><span class="line"><span class="cl"><span class="c1">-- | 3       |todo:2020-03-09 21:49:49.370621+08|
</span></span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://helium.github.io/tags/pgsql/">Pgsql</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://helium.github.io/posts/postgresql/table/">
    <span class="title">« 上一页</span>
    <br>
    <span>表和表空间</span>
  </a>
  <a class="next" href="https://helium.github.io/posts/grpc/ssl/">
    <span class="title">下一页 »</span>
    <br>
    <span>SSL/TLS 安全</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    
    <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv">
        本站总访问量<span id="busuanzi_value_site_pv"></span>次
    </span>
    <span id="busuanzi_container_site_uv">
        本站访客数<span id="busuanzi_value_site_uv"></span>人次
    </span>
    </div>
        <span>Copyright © 2024 蜀ICP备2024091074号 <a href="#">heliu's blog</a>. All rights reserved</span>  
    
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'Copy';

        function copyingDone() {
            copybutton.innerHTML = 'Done';
            setTimeout(() => {
                copybutton.innerHTML = 'Copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
